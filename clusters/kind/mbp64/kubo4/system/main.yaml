

gitRepositories:

  # This is here, as cluster dependant (repo/branch can be different by cluster)
  - name: kad-components
    watched: true
    interval: 30s
    protected: true
    ref:
      branch: sa-work1
    url: https://github.com/kubotal/kad-components.git

  - name: kad-data1
    interval: 30s
    url: https://github.com/SergeAlexandre/kad-data1.git

  - name: kad-data2
    interval: 30s
    url: https://github.com/SergeAlexandre/kad-data2.git

#   Replaced by flux-system/flux-system
#  - name: kad-infra-sa
#    url: ssh://git@github.com/kubotal/kad-infra-sa
#    ref:
#      branch: work1
#    secretRef: flux-system


loaders:

  - name: kad-data1
    source:
      gitRepository:
        name: kad-data1
    kadFiles:
      - data
    rules:
      document: '^data1-.*$'

  - name: kad-data2
    source:
      gitRepository:
        name: kad-data2
    kadFiles:
      - data
    rules:
      document: '^data2-.*$'



templateReleases:

  - name: cert-manager
    template:
      name: cert:cert-manager
      version: 1.0.0

  - name: metallb
    template:
      name: metallb
      version: 1.0.0



componentReleases:

  - name: ingress-nginx
    enabled: true
    component:
      name: ingress-nginx
      version: 1.0.0
    namespace: ingress-nginx

  - name: ingress-kubernetes
    enabled: true
    component:
      name: ingress-kubernetes
      version: 1.0.0
    namespace: ingress-nginx

  - name: kad-webserver
    enabled: true
    component:
      name: kad-webserver
      version: 1.0.0
      source:
        version: 0.5.0-snapshot
      parameters:
        debug: true
        deploymentLocation: clusters/kind/mbp64/kubo4/deployments
    namespace: flux-system


  - name: openldap
    enabled: true
    component:
      name: openldap
      version: 1.0.0
      parameters:
        ldapDomain: "odp.com"
        adminUser: admin
        adminPassword: admin123
        configUser: "admin"
        configPassword: admin123
        replicaCount: 2
      parameterFiles:
        - file: _data_/ldap-users-init.yaml
    namespace: openldap

